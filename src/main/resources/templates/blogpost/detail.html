<!doctype html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="~{fragments :: head(~{})}"></head>

<body>

<nav th:replace="~{fragments :: navbar}"></nav>

<main class="container-lg">

  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <p>
        <div class="d-flex justify-content-between">
          <h1 class="fw-bold" th:text="${blogPost.title}">blog post title</h1>
          <div sec:authorize="isAuthenticated()" th:if="${isCurrentAccountWriter}">
            <a th:href="@{/@{username}/blog-posts/{blogPostId}/edit(username=${blogPost.writer.username}, blogPostId=${blogPost.id})}"
               class="btn btn-sm btn-outline-dark"
               th:text="#{button.update}">update</a>
            <a th:href="@{/@{username}/blog-posts/{blogPostId}/settings(username=${blogPost.writer.username}, blogPostId=${blogPost.id})}"
               class="btn btn-sm btn-outline-dark"
               th:text="#{button.settings}">settings</a>
            <a class="btn btn-sm btn-outline-danger"
               th:text="#{button.delete}">delete</a>
          </div>
        </div>
      </p>
    </div>
  </div>

  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <p th:text="|${blogPost.writer.username} · ${#temporals.format(blogPost.createdDateTime, 'yyyy년 MM월 dd일')}|"></p>
    </div>
  </div>

  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <hr>
    </div>
  </div>

  <textarea id="content" th:text="${blogPost.content}" hidden></textarea>

  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10" id="target"></div>
  </div>

  <div class="row justify-content-center">
    <form class="col-lg-8 col-md-10 mb-3">
      <div class="mb-3">
        <label for="comment" class="form-label">Write Comment</label>
        <textarea class="form-control" id="comment" rows="3" style="resize: none"></textarea>
      </div>
      <button type="button" class="btn btn-dark btm-sm">Submit</button>
    </form>
  </div>

  <div class="row justify-content-center">

    <div class="col-lg-8 col-md-10 mb-3">
      <div class="d-flex mb-3">
        <div class="flex-shrink-0 align-self-center">
          <svg data-jdenticon-value="user" width="36" height="36"></svg>
        </div>
        <div class="flex-grow-1 ms-3">
          <div>username</div>
          <div class="text-muted">datetime</div>
        </div>
      </div>
      <div>
        Comment Contents...
      </div>
    </div>

    <div class="col-lg-8 col-md-10">
      <hr>
    </div>

    <div class="col-lg-8 col-md-10 mb-3">
      <div class="d-flex mb-3">
        <div class="flex-shrink-0 align-self-center">
          <svg data-jdenticon-value="user" width="36" height="36"></svg>
        </div>
        <div class="flex-grow-1 ms-3">
          <div>username</div>
          <div class="text-muted">datetime</div>
        </div>
      </div>
      <div>
        Comment Contents...
      </div>
    </div>

  </div>

</main>
<script src="/webjars/showdown/dist/showdown.min.js"></script>
<script type="application/javascript">
  const text = document.querySelector('#content').value;
  const target = document.querySelector('#target');
  const converter = new showdown.Converter();
  const html = converter.makeHtml(text);
  target.innerHTML = html;
</script>
</body>
</html>